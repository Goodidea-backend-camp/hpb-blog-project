# Happy Partner Blog PRD

## 1. 專案分析與背景介紹

### 1.1. 現有專案概覽

#### 分析來源

- **文件 - 專案產出：** 可在 `docs/brownfield-architecture.md` 中查閱。
- **使用者提供資訊：** 已提供使用者故事和技術需求。

#### 當前專案狀態

專案目前是一個全新的狀態，沒有現有的應用程式碼。`brownfield-architecture.md` 文件概述了使用 Nuxt.js、Go (Gin) 和 PostgreSQL 構建一個新的多使用者部落格應用程式的基礎計劃，所有這些都將透過 Docker 容器化。

### 1.2. 可用文件分析

#### 可用文件

- [x] 技術棧文件
- [x] 原始碼樹/架構
- [ ] 編碼標準（待定義，將在開發初期階段定義）
- [x] API 文件（建議）
- [ ] 外部 API 文件（不適用）
- [ ] UX/UI 指南（待定義，將在設計階段定義）
- [ ] 技術債文件（不適用，新構建）

### 1.3. 增強範圍定義

#### 增強類型

- [x] 新增功能

#### 增強描述

目標是從頭開始構建一個完整的多使用者部落格平台。這包括一個供讀者使用的公開網站和一個供作者/管理員管理內容的安全管理區域。

#### 影響評估

- [x] 重大影響（需要架構變更，因為我們正在構建初始架構）。

### 1.4. 目標與背景資訊

#### 目標

- 讀者可以瀏覽和閱讀文章。
- 管理員、作者可以安全登入以管理文章（創建、更新、刪除）。
- 應用程式具有可擴展性和可維護性。
- 應用程式完全在 Docker 容器內運行。
- UI 響應靈敏，並在桌面和行動裝置上提供良好的使用者體驗。

#### 背景資訊

這個專案從一個全新的儲存庫開始。目標是構建一個基礎的、良好架構的部落格應用程式，以便將來可以擴展。提供的使用者故事和技術需求是本次初始構建的主要驅動力。

### 1.5. 變更日誌

| 變更     | 日期       | 版本 | 描述         | 作者 |
| -------- | ---------- | ---- | ------------ | ---- |
| PRD 初稿 | 2025-08-29 | 1.0  | PRD 的第一稿 | PM   |

## 2. 需求

### 2.1. 功能性

- **FR1：** 系統應在首頁顯示所有已發布文章的列表，按發布日期排序（最新在前）。
- **FR2：** 列表中的每篇文章都應可點擊，點擊後導向顯示完整文章內容的獨立頁面。
- **FR3：** 文章頁面應顯示標題、內容和發布日期。
- **FR4：** 系統應在 `/admin/login` 路由提供一個安全的管理員/作者登入頁面。
- **FR5：** 經身份驗證的管理員、作者應能創建自己文章的標題和內容的新文章。
- **FR6：** 經身份驗證的管理員應能改變任何現有文章的狀態為隱藏/顯示。
- **FR7：** 經身份驗證的作者應能編輯任何現有自己文章的標題和內容。
- **FR8：** 經身份驗證的作者應看到一個列出自己所有文章的儀表板，並提供編輯或刪除每個文章的選項。

### 2.2. 非功能性

- **NFR1：** 整個應用程式堆疊（前端、後端、資料庫）必須使用 Docker 容器化，並透過 Docker Compose 管理。
- **NFR2：** 開發、測試和生產環境的配置必須保持獨立。
- **NFR3：** 後端服務應包含所有 API 請求和錯誤的結構化日誌記錄。
- **NFR4：** 前端應用程式必須響應靈敏，並在常見的桌面和行動裝置螢幕尺寸上正常運行。
- **NFR5：** 內容管理（創建、更新、刪除）的 API 端點必須受到保護，並且只能由經過身份驗證的使用者存取。

### 2.3. 相容性需求

- **CR1：** 後端 API 必須提供可供 Nuxt.js 前端消費的 JSON 回應。
- **CR2：** 資料庫架構必須透過遷移文件進行管理，以確保跨環境的一致性。
- **CR3：** 即使最初沒有正式的設計系統，管理面板的 UI/UX 也應簡潔直觀。

## 3. 使用者介面增強目標

### 3.1. 修改/新增畫面和視圖

- **公開：**
  - `/` (首頁)：所有文章列表。
  - `/posts/{id}`：單篇文章詳細視圖。
- **管理：**
  - `/admin/login`：登入頁面。
  - `/admin/dashboard`：所有文章列表，帶有編輯/刪除按鈕。
  - `/admin/posts/new`：創建新文章的表單。
  - `/admin/posts/edit/{id}`：編輯現有文章的表單。

## 4. 技術限制和整合需求

### 4.1. 現有技術棧

如 `docs/brownfield-architecture.md` 中定義：

- **語言**：Go, JavaScript (搭配 Nuxt.js)
- **框架**：Gin (Go), Nuxt.js
- **資料庫**：PostgreSQL
- **基礎設施**：Docker, Docker Compose

### 4.2. 整合方法

- **資料庫整合策略**：Go 後端將使用標準函式庫（如 `pgx`）連接到 PostgreSQL 資料庫。
- **API 整合策略**：Nuxt.js 前端將透過 RESTful API 與 Go 後端通信。
- **前端整合策略**：前端將採用單頁應用程式 (SPA) 樣式，從後端 API 獲取資料。

### 4.3. 程式碼組織與標準

- **檔案結構方法**：檔案結構將遵循 `docs/brownfield-architecture.md` 中建議的佈局。
- **命名約定**：將遵循標準的 Go 和 JavaScript 命名約定。
- **編碼標準**：將由程式碼檢查工具（例如 Go lint, ESLint）強制執行。

### 4.4. 風險評估與緩解

- **技術風險**：由於這是一個新構建，主要風險是所提議架構的錯誤實施。
- **緩解策略**：開發將分解為小的、連續的任務。每個任務將包括設置和基本實施，以驗證每個步驟的架構。

## 5. 史詩與故事結構

### 5.1. 史詩方法

**史詩結構決策**：將使用一個全面的史詩來追蹤部落格平台的初始構建，因為所有使用者故事都緊密相關，並且是一個統一功能集的一部分。

## 史詩 1：部落格平台初始構建

**史詩目標**：構建並推出基礎的多使用者部落格平台，使讀者能夠查看文章，管理員能夠管理文章。

### 故事 1.1：設置與後端基礎

- **作為一名** 開發者，
- **我想要** 設置帶有 Docker、資料庫連接和健康檢查端點的基本 Go 後端結構，
- **以便** 我有一個應用程式的工作基礎。
- **驗收標準**：
  1.  建立一個定義 `backend` 和 `db` 服務的 `docker-compose.yml` 文件。
  2.  Go 應用程式可以成功連接到 PostgreSQL 資料庫。
  3.  存在一個 `GET /health` API 端點並返回 `200 OK` 狀態。

### 故事 1.2：使用者與文章模型與遷移

- **作為一名** 開發者，
- **我想要** 為 `users` 和 `posts` 創建資料庫遷移和 Go 模型，
- **以便** 資料庫架構得到定義並可供使用。
- **驗收標準**：
  1.  為 `users` 表創建一個資料庫遷移文件。
  2.  為 `posts` 表創建一個資料庫遷移文件。
  3.  在 Go 後端中創建相應的 `User` 和 `Post` 結構。
  4.  應用程式啟動時遷移成功運行。

### 故事 1.3：前端基礎與文章顯示

- **作為一名** 開發者，
- **我想要** 設置帶有 Docker 的基本 Nuxt.js 前端並顯示一列模擬文章，
- **以便** 前端基礎到位並可以渲染資料。
- **驗收標準**：
  1.  `docker-compose.yml` 文件已更新以包含 `frontend` 服務。
  2.  Nuxt.js 應用程式渲染一個列出幾個硬編碼（模擬）文章的首頁。
  3.  前端經過樣式設計以實現響應式。

### 故事 1.4：文章 API

- **作為一名** 前端開發者，
- **我想要** 一個後端 API 來獲取所有文章和透過 ID 獲取單篇文章，
- **以便** 我可以顯示來自資料庫的真實資料。
- **驗收標準**：
  1.  創建 `GET /api/posts` 端點並返回資料庫中的文章列表。
  2.  創建 `GET /api/posts/{id}` 端點並返回單篇文章。
  3.  前端首頁調用 `GET /api/posts` 端點以顯示文章。
  4.  點擊首頁上的文章會導航到 `/posts/{id}` 並透過調用後端顯示正確的文章。

### 故事 1.5：管理員身份驗證

- **作為一名** 開發者，
- **我想要** 實施使用者創建（透過種子腳本）、登入端點和基於 JWT 的身份驗證中間件，
- **以便** 管理操作可以得到保護。
- **驗收標準**：
  1.  存在一個用於創建默認管理員使用者的種子腳本。
  2.  創建 `POST /api/login` 端點，用於驗證憑證並返回 JWT。
  3.  為 Gin 路由器創建一個身份驗證中間件以保護特定端點。

### 故事 1.6：管理員內容管理 API

- **作為一名** 前端開發者，
- **我想要** 安全的 API 端點來創建、更新、刪除和管理文章狀態，
- **以便** 我可以構建管理員內容管理 UI。
- **驗收標準**：
  1.  創建 `POST /api/posts` 端點並由身份驗證中間件保護。
  2.  創建 `PUT /api/posts/{id}` 端點並由身份驗證中間件保護。
  3.  創建 `DELETE /api/posts/{id}` 端點並由身份驗證中間件保護（用於永久刪除）。
  4.  創建 `PUT /api/posts/{id}/status` 端點並由身份驗證中間件保護，用於更新文章狀態（例如隱藏/顯示）。

### 故事 1.7：內容管理的管理員 UI

- **作為一名** 管理員/作者，
- **我想要** 一個使用者介面來登入和管理所有部落格文章，
- **以便** 我可以執行我的內容管理職責。
- **驗收標準**：
  1.  `/admin/login` 頁面允許管理員/作者登入並儲存接收到的 JWT。
  2.  `/admin/dashboard` 上的管理員儀表板列出經身份驗證的作者**自己的所有文章**，並具有「編輯」和「刪除」按鈕。
  3.  作者可以點擊「刪除」按鈕，成功調用 `DELETE /api/posts/{id}` API 並從列表中移除文章。
  4.  管理員/作者可以訪問 `/admin/posts/new` 頁面，該頁面提供一個表單，允許輸入標題和內容，透過調用 `POST /api/posts` API 創建新文章。
  5.  作者可以點擊文章旁的「編輯」按鈕，導航到 `/admin/posts/edit/{id}`，該頁面顯示一個預填了文章資料的表單，並允許透過 `PUT /api/posts/{id}` API 更新文章的標題和內容。
  6.  管理員可以在 `/admin/dashboard` 或文章編輯頁面看到一個選項來「隱藏」或「顯示」文章，該操作應呼叫 `PUT /api/posts/{id}/status` 端點。
